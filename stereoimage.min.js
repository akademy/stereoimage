// StereoImage - v1.0.13.120724 - http://www.akademy.co.uk/software/stereoimage/
function StereoImage(a){function u(a){switch(a){case"bothHorizontal":return t.bothHorizontal();case"bothVertical":return t.bothVertical();case"left":return t.left();case"right":return t.right();case"flick":return t.flick();case"stereoscopic":return t.stereoscopic();case"anaglyph":return t.anaglyph();default:return alert("Missing _drawing")}}function w(){j=v.getImageByName(g);q=j.width/2;r=j.height;f=e;u(m)}function x(){if(s!==c){clearTimeout(s);s=c}p.clearRect(0,0,o.width,o.height)}function y(a){switch(a){case"actual_size":return{w:q,h:r};case"size_to_canvas":return{w:o.width,h:o.height};case"size_to_canvas_with_aspect":var b=1;if(q>r){b=o.width*1/q}else{b=o.height*1/r}return{w:q*b,h:r*b};default:return alert("Missing _display")}}function z(a){var c=y(l);if(a===b){a=p}a.drawImage(j,0,0,j.width/2,j.height,0,0,c.w,c.h)}function A(a){var c=y(l);if(a===b){a=p}a.drawImage(j,j.width/2,0,j.width/2,j.height,0,0,c.w,c.h)}var b=undefined,c=null,d=false,e=true;var f=d;var g="3DIMAGE";var h=["actual_size","size_to_canvas","size_to_canvas_with_aspect"];var i=["bothHorizontal","bothVertical","left","right","flick","stereoscopic","anaglyph"];var j=c;var k=a["flick-rate"]!==b?a["flick-rate"]:150;var l=a["default-display-type"]!==b?h[a["default-display-type"]]:h[2];var m=a["default-draw-type"]!==b?i[a["default-draw-type"]]:i[3];var n=a["stereoscopic-scale"]!==b?a["stereoscopic-scale"]:1;var o=a["canvas"];if(o===b&&a["canvas-id"]!==b){o=document.getElementById("myCanvas")}if(o===b||o===c){return}var p=o.getContext("2d");var q=0,r=0;var s=c;var t=this;f=e;var v=c;v=new ImageLoader({images:[{name:g,file:a.filename}],onAllLoaded:function(){w()},onImageLoaded:function(a,b){}});this.setFlickRate=function(a){if(a>0){k=a;if(m==="flick"){u(m)}}};this.setStereoscopicScale=function(a){if(a>0&&a<=1){n=a;if(m==="stereoscopic"){u(m)}}};this.setSizing=function(a){if(a>=0&&a<h.length){l=h[a]}else{l=h[0]}u(m)};this.bothHorizontal=function(){m="bothHorizontal";x();var a=y(l);p.drawImage(j,0,0,q,r,0,0,a.w,a.h/2);p.drawImage(j,q,0,q,r,0,a.h/2,a.w,a.h/2)};this.bothVertical=function(){m="bothVertical";x();var a=y(l);p.drawImage(j,0,0,j.width,j.height,0,0,a.w,a.h)};this.left=function(){m="left";x();z()};this.right=function(){m="right";x();A()};this.flick=function(){m="flick";x();var a=y(l);var b=e;A();s=setInterval(function(){if(b){z()}else{A()}b=!b},k)};this.stereoscopic=function(){m="stereoscopic";var a=y(l);var b=3;var c=b*3;var d=c*2;a.h-=d;a.w*=n;var f=a.w*1/j.width;a.h=j.height*f;x();p.fillStyle="black";p.beginPath();p.arc(a.w/4,c,b,0,Math.PI*2,e);p.arc(a.w*3/4,c,b,0,Math.PI*2,e);p.fill();p.drawImage(j,0,0,j.width,j.height,0,d,a.w,a.h)};this.anaglyph=function(){m="anaglyph";var a=y(l);var b=document.createElement("canvas");b.width=a.w;b.height=a.h;var c=b.getContext("2d");z(c);var d=c.getImageData(0,0,a.w,a.h);A(c);var e=c.getImageData(0,0,a.w,a.h);var f=e.width,g=e.height,h=0,i=0,j=0,k=0;for(;j<g;j++){h=j*f;for(k=0;k<f;k++){i=(h+k)*4;e.data[i]=d.data[i]}}x();p.putImageData(e,0,0)}}StereoImage.prototype.toString=function(){return"StereoImage class"}
