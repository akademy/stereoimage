function StereoImage(w){var A=undefined,y=null,u=false,l=true;var g=u;var h="3DIMAGE";var o=["actual_size","size_to_canvas","size_to_canvas_with_aspect"];var j=["bothHorizontal","bothVertical","left","right","flick","stereoscopic","anaglyph"];var r=y;var i=(w["flick-rate"]!==A)?w["flick-rate"]:150;var f=(w["default-display-type"]!==A)?o[w["default-display-type"]]:o[2];var n=(w["default-draw-type"]!==A)?j[w["default-draw-type"]]:j[3];var v=(w["stereoscopic-scale"]!==A)?w["stereoscopic-scale"]:1;var p=w.canvas;if(p===A&&w["canvas-id"]!==A){p=document.getElementById("myCanvas")}if(p===A||p===y){return}var x=p.getContext("2d");var t=0,z=0;var c=y;var m=this;g=l;function e(B){switch(B){case ("bothHorizontal"):return m.bothHorizontal();case ("bothVertical"):return m.bothVertical();case ("left"):return m.left();case ("right"):return m.right();case ("flick"):return m.flick();case ("stereoscopic"):return m.stereoscopic();case ("anaglyph"):return m.anaglyph();default:return alert("Missing _drawing")}}var q=y;function d(){r=q.getImageByName(h);t=r.width/2;z=r.height;g=l;e(n)}q=new ImageLoader({images:[{name:h,file:w.filename}],onAllLoaded:function(){d()},onImageLoaded:function(B,C){}});function s(){if(c!==y){clearTimeout(c);c=y}x.clearRect(0,0,p.width,p.height)}function b(B){switch(B){case"actual_size":return{w:t,h:z};case"size_to_canvas":return{w:p.width,h:p.height};case"size_to_canvas_with_aspect":var C=1;if(t>z){C=(p.width*1)/t}else{C=(p.height*1)/z}return{w:t*C,h:z*C};default:return alert("Missing _display")}}function k(C){var B=b(f);if(C===A){C=x}C.drawImage(r,0,0,r.width/2,r.height,0,0,B.w,B.h)}function a(C){var B=b(f);if(C===A){C=x}C.drawImage(r,r.width/2,0,r.width/2,r.height,0,0,B.w,B.h)}this.setFlickRate=function(B){if(B>0){i=B;if(n==="flick"){e(n)}}};this.setStereoscopicScale=function(B){if(B>0&&B<=1){v=B;if(n==="stereoscopic"){e(n)}}};this.setSizing=function(B){if(B>=0&&B<o.length){f=o[B]}else{f=o[0]}e(n)};this.bothHorizontal=function(){n="bothHorizontal";s();var B=b(f);x.drawImage(r,0,0,r.width,r.height,0,0,B.w,B.h)};this.bothVertical=function(){n="bothVertical";s();var B=b(f);x.drawImage(r,0,0,t,z,0,0,B.w,B.h/2);x.drawImage(r,t,0,t,z,0,B.h/2,B.w,B.h/2)};this.left=function(){n="left";s();k()};this.right=function(){n="right";s();a()};this.flick=function(){n="flick";s();var C=b(f);var B=l;a();c=setInterval(function(){if(B){k()}else{a()}B=!B},i)};this.stereoscopic=function(){n="stereoscopic";var C=b(f);var E=3;var D=E*3;var B=D*2;C.h-=B;C.w*=v;var F=(C.w*1)/r.width;C.h=r.height*F;s();x.fillStyle="black";x.beginPath();x.arc(C.w/4,D,E,0,Math.PI*2,l);x.arc(C.w*3/4,D,E,0,Math.PI*2,l);x.fill();x.drawImage(r,0,0,r.width,r.height,0,B,C.w,C.h)};this.anaglyph=function(){n="anaglyph";var L=b(f);var D=document.createElement("canvas");D.width=L.w;D.height=L.h;var F=D.getContext("2d");k(F);var B=F.getImageData(0,0,L.w,L.h);a(F);var K=F.getImageData(0,0,L.w,L.h);var C=K.width,J=K.height,G=0,H=0,E=0,I=0;for(;E<J;E++){G=E*C;for(I=0;I<C;I++){H=(G+I)*4;K.data[H]=B.data[H]}}s();x.putImageData(K,0,0)}}StereoImage.prototype.toString=function(){return"StereoImage class"};
